{% load static %}

<!DOCTYPE html>
<html lang="zxx">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>MS Collections - Fashion eCommerce HTML Template</title>
    <!-- favicon -->
    <link rel="icon" href="{% static 'assets/img/favicon.png' %}" sizes="20x20" type="image/png">
    <!-- Vendor Stylesheet -->
    <link rel="stylesheet" href="{% static 'assets/css/vendor.css' %}">
    <!-- Main Stylesheet -->
    <link rel="stylesheet" href="{% static 'assets/css/style.css' %}">
    <!-- responsive Stylesheet -->
    <link rel="stylesheet" href="{% static 'assets/css/responsive.css' %}">
    <!-- Font Awesome CDN -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
    
    

    
    
    
    <style>
    
        #images {
            max-width: 30%;
            position: absolute;
            filter: grayscale(100%) brightness(0%) contrast(150%);
            top: -49px;
        }
        .product-image {
            max-width: 100px;
            cursor: pointer;
        }
        .action .btn-remove, .action .btn-edit {
            padding: 5px 10px;
            font-size: 14px;
        }
        .action .btn-edit i {
            color: #fff;
        }
        .quantity-form input[type="number"] {
            width: 60px;
            display: inline-block;
            margin-right: 10px;
        }
    </style>
</head>

<body>
    <!-- preloader area start -->
    <div class="preloader" id="preloader">
        <div class="preloader-inner">
            <div class="spinner">
                <div class="dot1"></div>
                <div class="dot2"></div>
            </div>
        </div>
    </div>
    <!-- preloader area end -->

    <!-- search Popup -->
    <div class="body-overlay" id="body-overlay"></div>
    <div class="search-popup" id="search-popup">
        <form action="" class="search-form">
            <div class="form-group">
                <input type="text" class="form-control" placeholder="Search.....">
            </div>
            <button type="submit" class="submit-btn"><i class="fa fa-search"></i></button>
        </form>
    </div>
    <!-- search Popup end -->

    <!-- sidebar menu start -->
    <div class="sidebar-menu" id="sidebar-menu">
        <button class="sidebar-menu-close">X</button>
        <div class="sidebar-inner">
            <div class="sidebar-logo">
                <img src="{% static 'assets/img/logo.png' %}" alt="">
            </div>
            <div class="sidemenu-text">
                <p>We believe brand interaction is key in communication. Real innovations and a positive customer experience are the heart of successful communication.</p>
            </div>
            <div class="sidebar-contact">
                <h4>Contact Us</h4>
                <ul>
                    <li><i class="fa fa-map-marker"></i>Edmonton Alberta.</li>
                    <li><i class="fa fa-envelope"></i> Marysmartcollections@gmail.com</li>
                    <li><i class="fa fa-phone"></i>+1(780)8632797</li>
                </ul>
            </div>
            <div class="sidebar-subscribe">
                <input type="text" placeholder="Email">
                <button><i class="fa fa-long-arrow-right"></i></button>
            </div>
            <div class="social-link">
                <ul>
                    <li><a href="#"><i class="fa fa-facebook-f"></i></a></li>
                    <li><a href="#"><i class="fa fa-twitter"></i></a></li>
                    <li><a href="#"><i class="fa fa-instagram"></i></a></li>
                    <li><a href="#"><i class="fa fa-pinterest"></i></a></li>
                </ul>
            </div>
        </div>
    </div>
    <!-- sidebar menu end -->

    <!-- navbar start -->
    <div class="stoon-navbar">
        <div class="header-top d-none d-sm-block">
            <div class="container-fluid">
                <div class="row align-items-center">
                    <div class="col-lg-4 col-8">
                        <div class="contact">
                            <a href="tel:+(1780)8632797"><i class="icon-call-header"></i> +1(780)8632797</a>
                            <a href="#"><i class="icon-email-subscribe"></i> Marysmartcollections@gmail.com</a>
                        </div>
                    </div>
                    <div class="col-lg-4 d-none d-lg-block">
                        <div class="shipping text-center">
                            <p>FREE SHIPPING - <span>on all orders over $35*</span></p>
                        </div>
                    </div>
                    <div class="col-lg-4 col-4">
                        <div class="social">
                            <ul class="nav-social justify-content-end">
                                <li><a href="https://vm.tiktok.com/ZMSjn3ey1/"><i class="fab fa-tiktok"></i> TikTok</a></li>
                                <li><a href="https://www.instagram.com/reel/DJm-0GYhet-/?utm_source=ig_web_copy_link"><i class="icon-instagram"></i> Instagram</a></li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <nav class="navbar navbar-area navbar-expand-lg nav-style-01">
            <div class="container-fluid nav-container">
                <div class="row">
                    <div class="col-lg-3 col-4 order-1 align-self-center">
                        <div class="logo">
                            <a href="{% url 'Ecommerce:home' %}"><img id="images" src="{% static 'assets/img/logo.png' %}" alt=""></a>
                        </div>
                    </div>
                    <div class="col-lg-6 order-3 order-lg-2">
                        <div class="collapse navbar-collapse" id="shop-menu">
                            <ul class="navbar-nav menu-open">
                                <li><a href="{% url 'Ecommerce:home' %}">Home</a></li>
                                <li class="menu-item-has-children">
                                    <a href="#">Shop <i class="fa fa-angle-down"></i></a>
                                    <ul class="sub-menu">
                                        <li><a href="{% url 'Ecommerce:collection-full' %}">Shop Full</a></li>
                                    </ul>
                                </li>
                                <li class="menu-item-has-children">
                                    <a href="#">Pages <i class="fa fa-angle-down"></i></a>
                                    <ul class="sub-menu">
                                        <li><a href="{% url 'Ecommerce:blog' %}">Blog</a></li>
                                        
                                        <li><a href="{% url 'cart:cart_detail' %}">Shopping Cart</a></li>
                                        <li><a href="{% url 'Ecommerce:coming-soon' %}">Coming Soon</a></li>
                                        <li><a href="{% url 'accounts:login' %}">Log-In Account</a></li>
                                    </ul>
                                </li>
                                <li><a href="{% url 'Ecommerce:about' %}">About Us</a></li>
                                <li><a href="{% url 'Ecommerce:contact' %}">Contact us</a></li>
                            </ul>
                        </div>
                    </div>
                    <div class="col-lg-3 col-8 justify-content-end d-flex order-2 order-lg-3">
                        <div class="nav-right-part">
                            <ul>
                                <li><a href="#" id="search"><i class="icon-search"></i></a></li>
                                <li><a href="#"><i class="icon-heart"></i><span class="badge"></span></a></li>
                                <li class="has-dropdown">
                                    <a href="{% url 'cart:cart_detail' %}"><i class="icon-add-to-cat"></i><span class="badge">{{ cart|length }}</span></a>
                                </li>
                                <li>
                                    <a href="#"><i class="icon-user"></i></a>
                                    <ul class="user-dropdown">
                                        <li><a href="{% url 'accounts:login' %}">Sign In | Join</a></li>
                                        <li><a href="{% url 'accounts:login' %}"><i class="icon-user"></i> My Account</a></li>
                                        <li><a href="#"><i class="fa fa-briefcase"></i> My Orders</a></li>
                                        <li><a href="#"><i class="fa fa-reply"></i> Returns Information</a></li>
                                        <li><a href="#"><i class="fa fa-commenting-o"></i> Contact Preferences</a></li>
                                    </ul>
                                </li>
                                <li class="d-none d-lg-block">
                                    <a href="#" id="navigation-button"><i class="icon-bar-icon"></i></a>
                                    </li>
                                </ul>
                            </div>
                            <div class="responsive-mobile-menu">
                                <div class="menu toggle-btn d-block d-lg-none" data-toggle="collapse" data-target="#shop-menu" aria-expanded="false" role="button">
                                    <div class="icon-left"></div>
                                    <div class="icon-right"></div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </nav>
        </div>
        <!-- navbar end -->

        <!-- breadcrumb start -->
        <div class="breadcrumb-area">
            <div class="container">
                <div class="row">
                    <div class="col-md-12">
                        <div class="breadcrumb-inner d-flex justify-content-between">
                            <h2 class="page-title">Shopping Cart</h2>
                            <ul class="page-list">
                                <li><a href="{% url 'Ecommerce:home' %}">Home</a></li>
                                <li><a href="{% url 'cart:cart_detail' %}">Shopping Cart</a></li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <!-- breadcrumb end -->

        <!-- cart area start -->
        <div class="cart-area margin-top-60">
            <div class="container">
                <div class="row">
                    <div class="col-xl-9 col-lg-8">
                        <div class="cart-content margin-top-20">
                            <table class="table table-bordered table-responsive">
                                <thead>
                                    <tr class="text-center">
                                        <th scope="col">Product</th>
                                        <th scope="col">Price</th>
                                        <th scope="col">Quantity</th>
                                        <th scope="col">Total</th>
                                        <th scope="col">Edit</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    {% for item in cart %}
                                        {% with product=item.product %}
                                            <tr>
                                                <th scope="row" class="d-flex">
                                                    <div class="left">
                                                        <img onclick="location.href='{{ product.get_absolute_url }}'" src="{% if product.image %}{{ product.image.url }}{% else %}{% static 'img/no_image.png' %}{% endif %}" class="product-image">
                                                    </div>
                                                    <div class="right">
                                                        <h6 class="name">{{ product.name }}</h6>
                                                        <h6 class="title">Size: <span class="values">{{ item.size|default:"N/A" }}</span></h6>
                                                    </div>
                                                </th>
                                                <td>${{ item.new_price }}</td>
                                                <td>
                                                 <form class="quantity-form" data-product-id="{{ product.id }}">
                                                        {% csrf_token %}
                                                        <input type="number" name="quantity" value="{{ item.quantity }}" min="1" class="form-control d-inline-block">
                                                        <input type="hidden" name="override" value="true">
                                                           <button type="submit" class="btn btn-sm btn-primary">Update</button>
                                                    </form> 
                                                </td>
                                                <td>${{ item.total_price }}</td>
                                                <td>
                                                    <div class="action">
                                                        <button type="button" class="btn btn-sm btn-danger btn-remove" data-product-id="{{ product.id }}">Remove</button>
                                                        <a href="#" class="btn btn-sm btn-warning btn-edit" data-product-id="{{ product.id }}"><i class="fa fa-pencil"></i></a>
                                                    </div>
                                                </td>
                                            </tr>
                                        {% endwith %}
                                    {% empty %}
                                        <tr>
                                            <td colspan="5" class="text-center">Your cart is empty.</td>
                                        </tr>
                                    {% endfor %}
                                </tbody>
                            </table>
                            <div class="d-flex justify-content-between margin-top-30">
                                <div class="btn-wrapper">
                                    <a href="{% url 'Ecommerce:collection-full' %}" class="btn btn-continue">Continue Shopping</a>
                                </div>
                                <div class="btn-wrapper">
                                    <a href="#" class="btn btn-clear" id="clear-cart">Clear Shopping Cart</a>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-xl-3 col-lg-4">
                        <div class="summary margin-top-20">
                            <h6 class="title">Summary</h6>
                            <h6 class="subtitle">Estimate Shipping and Tax</h6>
                            <p class="destination">Enter your destination to get a shipping estimate.</p>
                            <form action="#">
                                <div class="form-group">
                                    <label>Country</label>
                                    <select class="form-control cart-select">
                                        <option>United States</option>
                                        <option>Italy</option>
                                        <option>Bangladesh</option>
                                        <option>London</option>
                                    </select>
                                    <i class="fa fa-chevron-down"></i>
                                </div>
                                <div class="form-group">
                                    <label>State/Province</label>
                                    <select class="form-control cart-select">
                                        <option>Region/state</option>
                                        <option>Italy</option>
                                        <option>Bangladesh</option>
                                        <option>London</option>
                                    </select>
                                    <i class="fa fa-chevron-down"></i>
                                </div>
                                <div class="form-group">
                                    <label>Zip / Postal Code</label>
                                    <input type="text">
                                </div>
                                <div class="form-group">
                                    <label>Flat Rate</label>
                                    <div class="custom-control custom-checkbox mb-3">
                                        <input type="checkbox" class="custom-control-input" id="customCheck" name="example1">
                                        <label class="custom-control-label" for="customCheck">Fixed: $5.00</label>
                                    </div>
                                </div>
                                <div class="d-flex justify-content-between total">
                                    <p>Subtotal</p>
                                    <p>${{ cart.get_total_price }}</p>
                                </div>
                                <div class="d-flex justify-content-between total">
                                    <p>Shipping</p>
                                    <p>$5.00</p> <!-- Adjust dynamically if needed -->
                                </div>
                                <div class="d-flex justify-content-between total">
                                    <p>Order Total</p>
                                    <p>${{ cart.get_total_price|add:"5.00" }}</p> <!-- Adjust dynamically -->
                                </div>
                                <div class="form-group margin-top-20">
                                    <label>Apply Discount Code</label>
                                    <input type="text" placeholder="Enter discount code">
                                </div>
                            </form>
                            <div class="btn-wrapper">
                                <!-- <a href="{% url 'accounts:login' %}" class="btn btn-checkout">Proceed To Checkout</a> -->
                                <a href="{% url 'cart:checkout' %}" class="btn btn-checkout">Proceed To Checkout</a>
                            </div>
                            <h6 class="subtitle text-center">Checkout with Multiple Addresses</h6>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <!-- cart area end -->

        <!-- instagram start -->
    <div class="instagram-area margin-top-75">
        <div class="container">
            <div class="row">
                <div class="col-md-12 text-center">
                    <div class="instagram-title margin-bottom-40">
                        <h4> <span>
    @ <a href="https://www.instagram.com/reel/DJm-0GYhet-/?utm_source=ig_web_copy_link" target="_blank">FOLLOW</a>
  </span>
  US ON INSTAGRAM
</h4>
                    </div>
                </div>
            </div>
            <div class="row">
                <div class="col-md-12">
                    <div class="instagram-slider2">
                        <div class="thumb">
                            <img src="{% static 'assets/img/instagram/1.png' %}" alt="">
                        </div>
                        <div class="thumb">
                            <img src="{% static 'assets/img/instagram/2.png' %}" alt="">
                        </div>
                        <div class="thumb">
                            <img src="{% static 'assets/img/instagram/3.png' %}" alt="">
                        </div>
                        <div class="thumb">
                            <img src="{% static 'assets/img/instagram/4.png' %}" alt="">
                        </div>
                        <div class="thumb">
                            <img src="{% static 'assets/img/instagram/5.png' %}" alt="">
                        </div>
                        <div class="thumb">
                            <img src="{% static 'assets/img/instagram/6.png' %}" alt="">
                        </div>
                        <div class="thumb">
                            <img src="{% static 'assets/img/instagram/6.png' %}" alt="">
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- instagram end -->


        <!-- footer area start -->
        <footer class="footer-area footer-style-1 padding-top-70 margin-top-70">
            <div class="footer-top padding-bottom-50">
                <div class="container">
                    <div class="row">
                        <div class="col-lg-3 col-md-6">
                            <div class="widget widget_nav_menu">
                                <h4 class="widget-title">CATEGORIES</h4>
                                <ul>
                                    <li><a href="{% url 'Ecommerce:home' %}">Women</a></li>
                                    <li><a href="{% url 'Ecommerce:home' %}">Girls</a></li>
                                </ul>
                            </div>
                        </div>
                        <div class="col-lg-3 col-md-6">
                            <div class="widget widget_nav_menu">
                                <h4 class="widget-title">OUR POLICY</h4>
                                <ul>
                                    <li><a href="{% url 'Ecommerce:contact' %}">Contact Us</a></li>
                                    <li><a href="{% url 'accounts:login' %}">My Account</a></li>
                                </ul>
                            </div>
                        </div>
                        <div class="col-lg-4 col-md-6">
                            <div class="widget contact-widget">
                                <h4 class="widget-title">GET IN TOUCH</h4>
                                <ul class="contact_info_list">
                                    <li class="single-info-item">
                                        <div class="icon">
                                            <i class="icon-home-foother"></i>
                                        </div>
                                        <div class="details">
                                            <span>Edmonton Alberta.<br>P.O. Box 16023 13 Ave SW. <br>T6W 3N6rfv</span>
                                        </div>
                                    </li>
                                    <li class="single-info-item">
                                        <div class="icon">
                                            <i class="icon-email-subscribe"></i>
                                        </div>
                                        <div class="details">
                                            Marysmartcollections@gmail.com
                                        </div>
                                    </li>
                                    <li class="single-info-item">
                                        <div class="icon">
                                            <i class="icon-call-footer"></i>
                                        </div>
                                        <div class="details">
                                            <a href="tel:+17808632797">+1(780)8632797</a>
                                        </div>
                                    </li>
                                </ul>
                            </div>
                        </div>
                        <div class="col-lg-2 col-md-6">
                            <div class="widget widget_nav_menu">
                                <h4 class="widget-title">FOLLOW US</h4>
                                <ul>
                                    <li><a href="https://vm.tiktok.com/ZMSjn3ey1/"><i class="fab fa-tiktok"></i> TikTok</a></li>
                                    <li><a href="https://www.instagram.com/reel/DJm-0GYhet-/?utm_source=ig_web_copy_link"><i class="icon-instagram"></i> Instagram</a></li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="footer-bottom">
                <div class="container">
                    <div class="row">
                        <div class="col-md-6 align-self-center">
                            <p>© Marysmartcollections 2020. Powered with <i class="fa fa-heart"></i> by <a href="http://chinazaportfollio.vercel.app" target="_blank">Zwin</a>.</p>
                        </div>
                        <div class="col-md-6">
                            <ul>
                                <li><a href="#"><img src="{% static 'assets/img/payment/1.png' %}" alt=""></a></li>
                                <li><a href="#"><img src="{% static 'assets/img/payment/2.png' %}" alt=""></a></li>
                                <li><a href="#"><img src="{% static 'assets/img/payment/3.png' %}" alt=""></a></li>
                                <li><a href="#"><img src="{% static 'assets/img/payment/4.png' %}" alt=""></a></li>
                                <li><a href="#"><img src="{% static 'assets/img/payment/5.png' %}" alt=""></a></li>
                                <li><a href="#"><img src="{% static 'assets/img/payment/6.png' %}" alt=""></a></li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </footer>
        <!-- footer area end -->

        <!-- back to top area start -->
        <div class="back-to-top">
            <span class="back-top"><i class="fa fa-angle-up"></i></span>
        </div>
        <!-- back to top area end -->

        <!-- all plugins here -->
        <script src="{% static 'assets/js/vendor.js' %}"></script>
        <!-- main js -->
        <script src="{% static 'assets/js/main.js' %}"></script>
        <!-- jQuery -->
        <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
        <script>
            $(document).ready(function() {
                // Remove Product
                $('.btn-remove').on('click', function() {
                    const productId = $(this).data('product-id');
                    $.ajax({
                        url: `{% url 'cart:cart_remove' 0 %}`.replace('0', productId),
                        type: 'POST',
                        headers: {'X-CSRFToken': '{{ csrf_token }}'},
                        success: function(response) {
                            if (response.success) {
                                location.reload(); // Refresh to update cart
                            } else {
                                alert('Error removing product: ' + response.message);
                            }
                        },
                        error: function() {
                            alert('Error removing product');
                        }
                    });
                });

                // Update Quantity
                $('.quantity-form').on('submit', function(e) {
                    e.preventDefault();
                    const productId = $(this).data('product-id');
                    const formData = $(this).serialize();
                    $.ajax({
                        url: `{% url 'cart:cart_update' 0 %}`.replace('0', productId),
                        type: 'POST',
                        data: formData,
                        headers: {'X-CSRFToken': '{{ csrf_token }}'},
                        success: function(response) {
                            if (response.success) {
                                location.reload(); // Refresh to update cart
                            } else {
                                alert('Error updating cart: ' + JSON.stringify(response.errors));
                            }
                        },
                        error: function() {
                            alert('Error updating cart');
                        }
                    });
                });

                // Trigger Quantity Form Submission on Edit Button Click
                $('.btn-edit').on('click', function(e) {
                    e.preventDefault();
                    const productId = $(this).data('product-id');
                    $(`.quantity-form[data-product-id="${productId}"]`).submit();
                });

                // Clear Cart
                $('#clear-cart').on('click', function(e) {
                    e.preventDefault();
                    if (confirm('Are you sure you want to clear your cart?')) {
                        $.ajax({
                            url: "{% url 'cart:cart_clear' %}",
                            type: 'POST',
                            headers: {'X-CSRFToken': '{{ csrf_token }}'},
                            success: function(response) {
                                if (response.success) {
                                    location.reload();
                                } else {
                                    alert('Error clearing cart');
                                }
                            },
                            error: function() {
                                alert('Error clearing cart');
                            }
                        });
                    }
                });
            });
        </script>
    </body>
</html>